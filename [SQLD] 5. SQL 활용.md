# 순수 관계 연산자 와 SQL 문장
**SELECT** 연산은 **WHERE** 절로 구현 
**PROJECT** 연산은 **SELECT** 절로 구현
**(NATURAL) JOIN** 연산은 다양한 **JOIN** 기능으로 구현
DIVDE 연산은 현재 사용 안함 


# 계층형 데이터
: 동일한 테이블에 계층적으로 상위와 하위 데이터가 포함된 데이터를 말한다.
ex) 사원테이블 에서는 사원들 사이에 상위 사원(관리자)과 하위 사원 관계가 존재하고 조직 테이블에서는 조직들 사이에 상위 조직과 하위 조직 관계가 존재한다. 
![](https://images.velog.io/images/yuhayung7296/post/06e764f5-628c-4adb-8981-09333c57118c/image.png)


# 셀프 조인(Self Join)
: 동일 테이블 사이의 조인을 말한다. 
따라서, **FROM 절에 동일 테이블이 두 번 이상 나타난다**. 동일 테이블 사이의 조인을 수행하면 테이블과 칼럼 이름이 모두 동일하기 때문에 식별을 위해 반드시 테이블 **별칭를 사용**해야 한다. 


# 메인쿼리와 서브쿼리 

![](https://images.velog.io/images/yuhayung7296/post/f73aae1f-fc31-4750-9e83-eb0211e3ceb3/image.png)

![](https://images.velog.io/images/yuhayung7296/post/92c9c6d4-3170-4434-a616-fde6bb1a248c/image.png)


![](https://images.velog.io/images/yuhayung7296/post/e4f080ba-6b86-4813-bdb7-32349aa7bf51/image.png)

## 서브쿼리 
- 다중 행 서브쿼리는 서브쿼리의 실행 결과가 항상 한 건 이하인 서브쿼리로서 IN ALL 등의 비교 연산자를 사용해야 한다.
- 다중 행 서브쿼리 비교 연산자는 단일 행 서브쿼리의 비교 연산자로도 사용할 수 있다.
- 비 연관 서브쿼리는 주로 메인 쿼리에 값을 제공하기 위한 목적으로 사용 한다. 


## 인라인 뷰 (Inline View)
서브쿼리의 결과가 마치 실행 시에 동적으로 생성된 테이블인 것처럼 사용할 수 있다.
인라인 뷰는 SQL문이 실행될 때만 임시적으로 생성되는 동적인 뷰이기 때문에 데이터베이스에 해당 정보가 저장되지 않는다. 

## 뷰 사용의 장점 
 - **독립성** 
 : 테이블 구조가 변경되어도 뷰를 사용하는 응용
 - **편리성**
 : 복잡한 질의를 뷰로 생성함으로써 관련 질의를 단순하게 작성할 수 있다. 또한 해당 형태의 SQL문을 자주 사용할 때 뷰를 이용하면 편리하게 사용할 수 있다. 
 - **보안성**
 : 직원의 급여정보와 같이 숨기고 싶은 정보가 존재한다면, 뷰를 생성할 때 해당 칼럼을 빼고 생성함으로써 사용자에게 정보를 감출 수 있다. 

## 서브쿼리 주의사항 

1. 서브쿼리를 괄로로 감싸서 사용한다. 
2. 서브쿼리는 당일행 또는 복수 행 비교 연산자와 함께 사용 가능하다. 
< 단일행 비교 >
연산자는 서브쿼리의 결과가 반드시 1건 이하이어야 하고 복수 행 비교 연산자는 서브쿼리의 결과 건수와 상관없다. 
3. 서브쿼리에서는 ORDER BY를 사용하지 못한다. 
ORDER BY절을 SELECT절에서 오직 한 개만 올 수 있기 때문에 ORDER BY 절은 메인 쿼리의 마지막 문장에 위치해야 한다. 


# 집계 그룹 함수

## ROLLUP 함수

- GROUP BY 같이 사용
- 소계나 총계 구하는 함수
- 칼럼의 입력순서 주의해야 한다. 

## GROUPING 

기존값 : 0
새로운 값 : 1


## GROUPING SETS 
**GROUPING SETS** 함수를 사용하여 입력된 인수들에 대한 개별 집계를 구할 수 있다. 


## CUBE 
 결합 가능한 모든 값에 대하여 다차원 집계를 생성한다.
 (나열된 모든 인수의 결합 가능한 집계가 출력된다.)
: **CUBE** 도 결과에 대한 정렬이 필요한 경우는 **ORDER BY** 절에 명시적으로 정렬 칼럼이 표시가 되어야 한다.  



# WINDOW FUNCTION 윈도우 함수

- OVER 문구가 키워드로 필수 포함된다.
- 분석함수(ANALYTIC FUNCTION), 순위함수 (RANK FUNCTION)
- 윈도우 함수로 처리로 인해 결과 건수가 줄지 않는다. 
- 윈도우 함수 적용 범위는 Partition을 넘을 수 없다. 


## 그룹내 순위 함수 
- **RANK 함수**
: ORDER BY를 포함한 QUERY 문에서 특정 항목(칼럼)에 대한 순위를 구하는 함수이며 동일한 값에 대해서는 동일한 순위를 부여 한다.
- **DENSE_RANK 함수**
: 동일한 순위를 하나의 건수로 취급, 중간순위를 안비움 
- **ROW_NUMBER 함수**
: 동일한 값이라도 고유한 순위를 부여한다는 점이 RANK, DENSE, RANK와 다르다.


# 이외 함수
## LAG 함수
: 파티션별 윈도우에서 이전 몇 번째 행의 값을 가져올 수 있다.

## LEAD 함수
: 파티션별 윈도우에서 이후 몇번째 행을 값을 가져 올 수 있다. 

![](https://images.velog.io/images/yuhayung7296/post/152530a3-a597-4daf-b620-fe3758916f0f/image.png)

[출처 및 + 도움되는 블로그 📌](https://gent.tistory.com/339)


# 절차형 SQL 
- SQL에도 절차 지향적인 프로그램이 기능하도록 DBMS 벤더별로 PL/SQL, SQL/PL, T-SQL 등의 절차형 SQL 제공

- 절차형 SQL을 사용하면 SQL문의 연속 적인 실행이나 조건에 따른 분기처리를 이용하여 특정기능을 수행하는 저장 모듈을 생성할 수 있다. 

# 저장 모듈(Stored Module)
SQL 문장을 데이터 베이스 서버에 저장하여 사용자와 애플리케이션 사이에서 공유할 수 있도록 만든 일종의 SQL컴포넌트 프로그램이며, 독립적으로 실행되거나 다른 프로그램으로 부터 실행될 수 있는 완전한 실행 프로그램이다.


# Trigger 
- 특정한 테이블에 INSERT, UPDATE DELETE 와 같은 DML 문이 수행되었을때, 데이터 베이스에서 자동적으로 동작하도록 작성된 프로그램.

- 데이터 베이스의 보안 의 적용, 유효하지 않은 트랜잭션의 예방, 업무 규칙자동 적용 제공등 사용

- Commit 및 Rollback 사용불가능 


# DCL 암기 (활용)
- **CREATE SESSION **
: 사용자로 로그인 하기 위해 시스템 권한이 필요하다. 

- **GRANT CREATE ANY TABLE TO U1;**
: 에러조치 권한 부여 = 다른 스키마에 테이블 생성 

- **GRANT UNLIMITED TABLESPACE TO U1;**
: 에러조치 권한 부여 = 테이블행 삽입

- **GRANT ALL NO T1 TO U1 ;**
: 모든 권한부여 T1 테이블 사용자 U1 에게

- **CREATE ROLE**
: 롤을 생성할 수 있다.

- **REVOKE ALL ON T1 FROM U1;**
: 권한 회수 


---
정말 외울것이 너무 많다.. ;; 🤦🏻‍♀️🔥🔥🔥🔥🔥
